/* Root variables */
:root{
  --bg-page: #f4f6fa;
  --text: #222;
  --topbar-bg: #ffffffcc;
  --topbar-shadow: rgba(0,0,0,0.1);
  --glass-border: #e0e4ec;
  --panel-bg: #ffffff;
  --cube-grad-1: #e9eef5;
  --cube-grad-2: #ffffff;
  --accent-green: #4CAF50;
  --muted: #ccc;
  --panel-scroll: #c5c9d6;
  --canvas-bg: #e9eef8;
  --btn-blue-start: #e0e7ff;
  --btn-blue-end: #cfd9ff;
  --next-blue-1: #6366f1;
  --next-blue-2: #4f46e5;
  --danger-red-1: #ffb3b3;
  --danger-red-2: #ff8080;
  --dark-bg: #0f1116;
  --dark-panel: #1c1f27;
}

/* ----- Reset / base ----- */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;transition:background-color .3s,color .3s,border-color .3s;}
body{
  background:var(--bg-page);
  color:var(--text);
  display:flex;
  flex-direction:column;
  height:100vh;
  overflow:hidden;
}

/* ----- Topbar ----- */
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:.8rem 2rem;
  background:var(--topbar-bg);
  backdrop-filter:blur(8px);
  box-shadow:0 2px 8px var(--topbar-shadow);
}
.topbar h1{font-weight:600;font-size:1.4rem;letter-spacing:.5px;}

/* status */
.status-container{display:flex;align-items:center;gap:3rem;}
.status{display:flex;align-items:center;gap:.5rem;}
.status-dot{width:12px;height:12px;border-radius:50%;background:gray;transition:background .3s;}
.status-dot.connected{background:var(--accent-green);}

/* ----- Main layout ----- */
.main-container{display:flex;flex:1;overflow:hidden;}

/* Cube area (70%) */
.cube-area{
  flex:0 0 70%;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(145deg,var(--cube-grad-1),var(--cube-grad-2));
  border-right:2px solid var(--glass-border);
}
#cuboContainer{width:100%;height:100%;border:1px solid #ccc;}

/* Side panel (30%) */
.side-panel{
  flex:0 0 30%;
  background:var(--panel-bg);
  padding:1.5rem;
  display:flex;
  flex-direction:column;
  border-left:2px solid var(--glass-border);
  overflow:hidden;
}
.panel-header{margin-bottom:1rem;border-bottom:2px solid var(--glass-border);}
.panel-header h2{font-size:1.2rem;color:#333;}

.panel-content{
  display:flex;flex-direction:column;align-items:center;gap:2rem;
  flex:1;justify-content:flex-start;overflow-y:auto;position:relative;padding-top:.5rem;
}

/* elegant scrollbar */
.panel-content::-webkit-scrollbar{width:6px;}
.panel-content::-webkit-scrollbar-thumb{background:var(--panel-scroll);border-radius:4px;}
.panel-content::-webkit-scrollbar-thumb:hover{background:#a9aec0;}

/* ----- Patterns grid ----- */
.patterns-container{display:grid;grid-template-columns:1fr 1fr;gap:1.1rem;padding:1rem;box-sizing:border-box;}
.pattern{
  width:100%;border-radius:10px;border:3px solid #ccc;
  box-shadow:0 2px 6px rgba(0,0,0,0.15);
  cursor:pointer;background-color:#fff;object-fit:cover;
}

/* ----- Bottom bar ----- */
.bottom-bar{
  display:flex;justify-content:space-between;align-items:center;
  padding:.7rem 2rem;backdrop-filter:blur(10px);
  border-top:1px solid #dfe3ea;box-shadow:0 -2px 8px rgba(0,0,0,0.05);
}
.bottom-left{flex:0 0 70%;display:flex;justify-content:center;gap:1.5rem;}
.bottom-right{flex:0 0 30%;text-align:right;}

/* ----- Buttons: base action-btn (placed early; will be overridden below if needed) ----- */
.action-btn{
  background:linear-gradient(135deg,var(--btn-blue-start),var(--btn-blue-end));
  border:none;padding:.8rem 1.6rem;border-radius:50px;font-size:1rem;cursor:pointer;color:#1a1a1a;
  transition:all .25s ease;box-shadow:0 4px 10px rgba(0,0,0,0.08);
}
.action-btn:hover:not(:disabled){transform:translateY(-3px);}

/* disabled */
.action-btn:disabled{opacity:.45;cursor:not-allowed;transform:none;}

/* Generic icon spacing in buttons */
.action-btn i{margin-right:.5rem;font-size:1.1rem;opacity:.8;transition:opacity .2s ease;}
.action-btn:hover i{opacity:1;}

/* ----- Canvas wrapper and point dot ----- */
.canvas-wrapper{
  position:relative;width:100%;padding-top:56.25%;background:var(--canvas-bg);
  border-radius:12px;overflow:hidden;border:1px solid #cfd8e6;
}
.point-canvas{position:absolute;left:0;top:0;width:100%;height:100%;display:block;border-radius:12px;}
.point-dot{width:18px;height:18px;border-radius:50%;transform:translate(-50%,-50%);position:absolute;pointer-events:none;}

/* ----- Camera / photos ----- */
.camera-view{width:100%;padding-top:56.25%;position:relative;background-color:#c0d8f0;border-radius:12px;overflow:hidden;}
.camera-view img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;}

.photos-container{display:flex;gap:1rem;justify-content:center;width:100%;}
.photo-box{
  flex:1;padding-top:28.125%;background-color:#e0e7ff;border-radius:10px;border:3px solid #ccc;
  position:relative;cursor:pointer;transition:all .15s ease;background-size:cover;background-position:center;
}
.photo-box.selected{border-color:var(--accent-green);box-shadow:0 0 8px rgba(76,175,80,0.7);}

/* ----- Step 2: point editing ----- */
.image-step2{display:flex;flex-direction:column;align-items:center;gap:2rem;width:100%;}
.img-wrapper{
  position:relative;width:90%;max-width:600px;aspect-ratio:16/9;background-color:#e0e7ff;border-radius:12px;overflow:hidden;
  box-shadow:0 4px 8px rgba(0,0,0,0.15);
}
.img-wrapper img{width:100%;height:100%;object-fit:cover;display:block;pointer-events:none;}
.points-canvas{position:absolute;top:0;left:0;width:100%;height:100%;z-index:2;}
.points-canvas.no-cursor{cursor:default !important;}

/* ----- Next button (variant) ----- */
.action-btn.next-btn{
  display:block;margin:.5rem auto 0;padding:1rem 1.2rem;background:linear-gradient(135deg,var(--next-blue-1),var(--next-blue-2));
  color:#fff;border:none;border-radius:8px;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,0.15);transition:background .2s ease,transform .1s ease;
  font-size:1rem;
}
.action-btn.next-btn:hover{background:#4338ca;transform:scale(1.03);}
.action-btn.next-btn:active{transform:scale(.97);}

/* also keep a .next-btn helper used elsewhere */
.next-btn{margin-top:8px;min-width:200px;max-width:320px;}

/* ----- Color buttons (consolidated) ----- */
.color-buttons-container{display:flex;gap:.5rem;justify-content:center;align-items:center;margin-top:12px;flex-wrap:wrap;}
.color-btn{
  width:34px;height:34px;border-radius:50%;border:3px solid rgba(0,0,0,0.16);box-shadow:0 2px 0 rgba(0,0,0,0.08);
  cursor:pointer;transition:transform .1s ease,border .1s ease;
}
.color-btn.selected{outline:3px solid rgba(0,0,0,0.08);transform:translateY(-2px);}

/* ----- Calibrate / controls column ----- */
.calibrate-row{display:flex;gap:12px;justify-content:center;align-items:center;margin:3px 0;flex-wrap:nowrap;}
.action-btn.calibrate-btn{
  padding:4px 12px;border-radius:10px;min-width:160px;max-width:260px;font-weight:700;font-size:14px;
  box-shadow:0 0px 0 rgba(0,0,0,0.18);transition:transform .12s ease,box-shadow .12s ease,background .12s ease;
  background:linear-gradient(180deg,#ffffff,#f2f2f2);border:1px solid rgba(0,0,0,0.12);color:#222;
}
.action-btn.calibrate-btn.active{
  background:linear-gradient(180deg,#2f5bd8,#2a4fc4);color:#fff;transform:translateY(-2px) scale(1.02);
  box-shadow:0 8px 18px rgba(46,88,209,0.18);border-color:rgba(0,0,0,0.18);
}

/* controls column layout */
.controls-column{display:flex;flex-direction:column;align-items:center;gap:12px;padding:0 18px 18px 18px;}

/* ----- Scan complete container ----- */
.scan-complete-container{
  display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;text-align:center;padding:2rem;
  background:#f5f5f5;gap:1.5rem;font-family:Arial,sans-serif;color:#333;
}
.scan-complete-container img{
  width:150px;height:150px;animation:spin 3s linear infinite;border-radius:20px;box-shadow:0 4px 15px rgba(0,0,0,0.2);
}
.scan-complete-container h2{font-size:1.8rem;font-weight:600;color:#2c3e50;margin:0;}
.scan-complete-container p{font-size:1.1rem;color:#555;}
.scan-complete-container .action-btn{
  background:linear-gradient(135deg,#4caf50,#2e7d32);color:#fff;border:none;border-radius:8px;padding:.8rem 1.5rem;
  font-size:1rem;cursor:pointer;transition:all .2s ease-in-out;box-shadow:0 3px 10px rgba(0,0,0,0.15);
}
.scan-complete-container .action-btn:hover{transform:translateY(-2px);box-shadow:0 6px 15px rgba(0,0,0,0.2);}

@keyframes spin{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}

/* ----- Small accessibility / utility ----- */
#pattern-preview{transition:transform .18s ease,box-shadow .18s ease;}
#pattern-preview:hover{transform:translateY(-4px);box-shadow:0 10px 26px rgba(0,0,0,0.12);}

/* credits */
.credits{display:flex;align-items:center;gap:8px;text-align:center;line-height:1.4;font-family:'Poppins',sans-serif;margin-left:3.7rem;}
.credits-title{font-size:1.2rem;color:#666;letter-spacing:.5px;margin-bottom:.1rem;}
.credits-names{font-size:1.1rem;font-weight:600;color:#222;transition:transform .25s ease,color .25s ease;}
.credits-names:hover{transform:translateY(-2px);color:#4f46e5;}

/* ----- Settings panel (base) ----- */
.settings-panel{
  display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;width:100%;height:100%;
  padding:25px;background:rgba(255,255,255,0.15);border-radius:14px;backdrop-filter:blur(10px);
  box-shadow:inset 0 0 10px rgba(0,0,0,0.1);box-sizing:border-box;overflow:hidden;
}
.settings-options{display:flex;flex-direction:column;gap:22px;}
.settings-btn-panel{
  background:linear-gradient(135deg,#3a7bd5,#00d2ff);border:none;color:#fff;padding:14px 18px;font-size:15px;border-radius:10px;
  cursor:pointer;transition:all .25s ease;text-align:center;font-weight:500;width:100%;
}
.settings-btn-panel:hover{transform:scale(1.03);box-shadow:0 4px 15px rgba(0,150,255,0.3);}
.settings-exit{margin-top:auto;background:linear-gradient(135deg,#d53369,#daae51);}
.settings-exit:hover{box-shadow:0 4px 15px rgba(213,51,105,0.4);}

/* ----- Compact settings additions (consolidated) ----- */
/* container tweaks */
.settings-panel{gap:13px;padding:10px;}
.settings-row{display:flex;gap:8px;align-items:center;width:100%;box-sizing:border-box;}
.two-columns{display:flex;gap:8px;}
.two-columns>div{flex:1;}
.main-btn{width:100%;padding:16px;border-radius:10px;border:none;font-weight:700;font-size:14px;background:linear-gradient(180deg,#2fc0ff,#1b94c9);color:#01262b;cursor:pointer;box-shadow:0 6px 18px rgba(13,64,86,0.06);}
.main-btn:active{transform:translateY(1px);}

/* resolution group */
.res-group{display:flex;flex-direction:column;gap:6px;width:100%;}
.res-label{display:none;}
.res-buttons{display:flex;gap:6px;width:100%;}
.res-btn{flex:1 1 0;padding:10px 6px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:linear-gradient(180deg,#e6f9ff,#d0f0ff);font-weight:800;font-size:13px;color:#02343a;cursor:pointer;text-align:center;transition:transform .15s ease,box-shadow .15s ease;}
.res-btn.selected{background:linear-gradient(180deg,#ffb86b,#ff8d28);color:#2b1700;box-shadow:0 6px 18px rgba(255,138,0,0.12);}
.res-btn:not(.selected):hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(3,59,86,0.06);}

/* velocity controls */
.vel-row{display:flex;gap:8px;align-items:center;width:100%;}
.vel-small{width:48px;height:48px;border-radius:10px;border:none;font-weight:900;font-size:20px;cursor:pointer;color:white;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#ff7862,#e84f39);}
/* right vel small variant (blue) */
.vel-small:last-child{background:linear-gradient(180deg,#6fe0ff,#2eb6e6);}
.vel-small:active{transform:translateY(1px);}
.vel-small.vel-blue{background:linear-gradient(180deg,#5cc9ff,#229bd6);color:#002b3a;}
.vel-pill{flex:1;display:flex;align-items:center;gap:12px;background:linear-gradient(180deg,#f9fbfe,#f1f8ff);border-radius:12px;padding:8px 12px;box-shadow:0 8px 20px rgba(16,40,64,0.04);}
.vel-pill input[type='range']{width:calc(100% - 120px);height:8px;border-radius:8px;background:linear-gradient(90deg,#2fb6e6,#ff8d28);outline:none;}
.vel-pill input[type='range']::-webkit-slider-thumb{-webkit-appearance:none;width:22px;height:22px;border-radius:50%;background:#fff;border:4px solid #0b6f86;box-shadow:0 4px 10px rgba(3,45,60,0.18);cursor:pointer;}
.vel-center{width:110px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;}
.vel-name{font-size:12px;color:#033;font-weight:700;}
.vel-value{font-size:14px;font-weight:900;color:#042;}

/* info / exit button variants */
.info-btn{background:linear-gradient(180deg,#298ed2,#29c0e0);color:#02323a;font-weight:700;border:1px solid rgba(0,80,120,0.08);}
.exit-btn{background:linear-gradient(180deg,#ffd6d6,#ffbdbd);color:#4a0000;font-weight:800;border:1px solid #e04b4b;}
.exit-btn{background:linear-gradient(180deg,#ff8080,#ff4b4b);color:#2b0b0b;border:1px solid #e04b4b;}

/* ultra-compact */
.ultra-compact .main-btn{padding:7px;font-size:13px;border-radius:8px;}
.ultra-compact .res-btn{padding:8px 6px;font-size:12px;border-radius:6px;}
.ultra-compact .vel-small{width:40px;height:40px;}
.ultra-compact .vel-center{width:90px;}

/* custom moves */
.custom-moves{width:100%;display:flex;flex-direction:column;gap:8px;align-items:center;}
.custom-btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px;}
.custom-moves-panel{display:flex;gap:8px;width:100%;justify-content:center;align-items:center;padding:6px 4px;}
.custom-moves-panel input[type='text']{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.08);font-size:13px;outline:none;min-width:220px;}
.custom-moves-panel .small{padding:8px 12px;font-size:13px;border-radius:8px;}
.custom-moves-panel .small.alt{background:linear-gradient(180deg,#f3f3f3,#e8e8e8);color:#222;border:1px solid rgba(0,0,0,0.06);}

/* custom label */
#custom-moves-label{font-weight:700;}

/* sanjo image */
.sanjo-image{width:100%;height:175px;display:flex;justify-content:center;align-items:center;margin:15px 0;}

/* theme toggle */
.theme-toggle {
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:26px;
  height:26px;
  border-radius:6px;
  font-size:14px;
  line-height:1;
  cursor:pointer;
  border:1px solid rgba(0,0,0,0.08);
  box-shadow: 0 2px 6px rgba(0,0,0,0.06);
  background: linear-gradient(180deg,#ffffff,#f0f0f0);
  color:#222;
  padding:0;
}

/* light variation */
.theme-toggle.theme-light {
  background: linear-gradient(180deg,#fffef5,#fff);
  border-color: rgba(0,0,0,0.06);
  background: rgba(0,0,0);
}

/* show sun emoji when light mode, moon when dark mode */
.theme-toggle::after {
  content: 'ðŸŒ™';
  
  display:inline-block;
  transform: translateY(-1px);
}
body.dark-mode .theme-toggle::after { content: 'â˜€ï¸'; }

/* add focus outline for keyboard users */
.theme-toggle:focus { outline: 3px solid rgba(79,70,229,0.18); outline-offset: 2px; }
/* gallery formatting */
#gallery-value{font-weight:500;color:inherit;}

/* ensure box-sizing on settings */
.settings-panel, .settings-panel *{box-sizing:border-box;}

/* =========================
   Dark mode overrides (grouped)
   ========================= */
body.dark-mode{
  background:var(--dark-bg);
  color:#f0f0f0;
}

/* topbar/panels */
body.dark-mode .topbar{background:#1a1d24cc;color:#eaeaea;box-shadow:0 2px 8px rgba(0,0,0,0.4);} 
body.dark-mode .status-dot{background:#666;} 
body.dark-mode .status-dot.connected{background:var(--accent-green);} 

body.dark-mode .cube-area{background:linear-gradient(145deg,#1c1f27,#14161c);border-right:2px solid #2b2f38;} 
body.dark-mode .side-panel{background:var(--dark-panel);border-left:2px solid #2b2f38;color:#f0f0f0;} 
body.dark-mode .panel-header{border-bottom:2px solid #2b2f38;} 
body.dark-mode .panel-header h2{color:#fff;} 
body.dark-mode .bottom-bar{border-top:1px solid #444;} 

/* patterns/backgrounds */
body.dark-mode .pattern{background-color:#22252e;border-color:#444;box-shadow:0 2px 6px rgba(0,0,0,0.4);} 

/* scrollbars */
body.dark-mode .panel-content::-webkit-scrollbar-thumb{background:#444;} 
body.dark-mode .panel-content::-webkit-scrollbar-thumb:hover{background:#666;} 

/* canvas & image wrappers */
body.dark-mode .canvas-wrapper,
body.dark-mode .img-wrapper,
body.dark-mode .photo-box{background-color:#1a1d25;border-color:#333;box-shadow:0 4px 8px rgba(0,0,0,0.4);} 

/* camera view */
body.dark-mode .camera-view{background-color:#222630;} 

/* scan-complete */
body.dark-mode .scan-complete-container{background:#1a1d25;color:#e0e0e0;} 
body.dark-mode .scan-complete-container h2{color:#fff;} 
body.dark-mode .scan-complete-container p{color:#bbbbbb;} 
body.dark-mode .scan-complete-container .action-btn{background:linear-gradient(135deg,#43a047,#2e7d32);} 

/* cubo container bg */
body.dark-mode #cuboContainer{background-color:#0c0e12;border-color:#222;} 

/* ------- Buttons: dark-mode color adjustments (grouped) ------- */
body.dark-mode .action-btn{
  background:linear-gradient(145deg,#2c2f3a,#3b4052);
  color:#e5e5e5;
  box-shadow:0 4px 10px rgba(0,0,0,0.4);
}

/* keep next-btn blue in dark */
body.dark-mode .action-btn.next-btn{
  background:linear-gradient(135deg,#3949ab,#283593);
  box-shadow:0 4px 10px rgba(57,73,171,0.4);
}
body.dark-mode .action-btn.next-btn:hover{background:linear-gradient(135deg,#3f51b5,#2e3a8c);} 

/* scan complete specific */
body.dark-mode .scan-complete-container .action-btn{background:linear-gradient(135deg,#43a047,#2e7d32);} 

/* credits */
body.dark-mode .credits-title{color:#aaa;} 
body.dark-mode .credits-names{color:#e5e5e5;} 

/* settings panel dark variations */
body.dark-mode .settings-panel{background:rgba(20,20,25,0.8);box-shadow:inset 0 0 12px rgba(0,0,0,0.6);} 
body.dark-mode .settings-btn-panel{background:linear-gradient(135deg,#0062ff,#00c6ff);} 
body.dark-mode .settings-exit{background:linear-gradient(135deg,#ff4b2b,#ff416c);} 

/* =========================
   Modern Action Buttons (red 'premium')
   - preserved as later override (keeps cascade intent)
   ========================= */
.action-btn{
  position:relative;overflow:hidden;
  background:linear-gradient(145deg,var(--danger-red-1),var(--danger-red-2));
  border:1px solid #e66868;padding:.9rem 1.8rem;border-radius:14px;font-size:1rem;font-weight:600;color:#2c2c2c;
  cursor:pointer;transition:all .25s ease;box-shadow:4px 4px 10px rgba(0,0,0,0.08),-3px -3px 10px rgba(255,255,255,0.7);
}
.action-btn:hover:not(:disabled){
  transform:translateY(-2px);
  box-shadow:6px 6px 14px rgba(0,0,0,0.1),-4px -4px 14px rgba(255,255,255,0.8);
  background:linear-gradient(145deg,#ff8080,#ff9999);
}
.action-btn:active{transform:scale(.97);box-shadow:inset 3px 3px 6px rgba(0,0,0,0.15),inset -3px -3px 6px rgba(255,255,255,0.8);} 
.action-btn:disabled{opacity:.6;cursor:not-allowed;}

/* Dark-mode premium red adjustments and shine */
body.dark-mode .action-btn{
  background:linear-gradient(145deg,#b50000,#8b0000);color:#ffeaea;box-shadow:3px 3px 8px rgba(0,0,0,0.6),-3px -3px 8px rgba(255,255,255,0.08);
}
body.dark-mode .action-btn:hover{
  background:linear-gradient(145deg,#cc0000,#990000);
  box-shadow:5px 5px 10px rgba(0,0,0,0.6),-3px -3px 10px rgba(255,255,255,0.1);
}

/* Next-btn keeps explicit blue styling (override) */
.action-btn.next-btn{
  background:linear-gradient(135deg,#6366f1,#4f46e5);color:#fff;border:1px solid #25207a;
  box-shadow:0 4px 12px rgba(99,102,241,0.4),0 0 0 2px rgba(255,255,255,0.2) inset;
}
.action-btn.next-btn:hover{background:linear-gradient(135deg,#4f46e5,#4338ca);} 
.action-btn.next-btn:active{transform:scale(.96);}

/* Dark-mode: ensure next-btn contrast */
body.dark-mode .action-btn.next-btn{background:linear-gradient(135deg,#3949ab,#283593);box-shadow:0 4px 10px rgba(57,73,171,0.4);} 
body.dark-mode .action-btn.next-btn:hover{background:linear-gradient(135deg,#3f51b5,#2e3a8c);} 

/* animated diagonal shine (dark mode) */
body.dark-mode .action-btn{position:relative;overflow:hidden;} 
body.dark-mode .action-btn::before{
  content:'';position:absolute;top:0;left:-120%;width:120%;height:100%;
  background:linear-gradient(120deg,transparent,rgba(255,255,255,0.25),transparent);
  transition:all .6s ease;pointer-events:none;
}
body.dark-mode .action-btn:hover::before{left:100%;}

/* ===== small niceties left as-is to preserve behaviour ===== */
.res-btn.selected{background:linear-gradient(180deg,#ffb86b,#ff8d28);color:#2b1700;box-shadow:0 6px 18px rgba(255,138,0,0.12);outline:2px solid #ffd54f;} 
.vel-pill input[type='range']::-webkit-slider-thumb{ -webkit-appearance:none; } 
.ultra-compact .main-btn{padding:7px;font-size:13px;border-radius:8px;} 
/* keep box-sizing safety */
.settings-panel, .settings-panel *{box-sizing:border-box;}

/* =========================
   SETTINGS: compact layout & gallery pill slider
   ========================= */

/* Prevent internal scroll when settings is open */
.panel-content.settings-open { overflow-y: hidden !important; }

/* Compact grid for settings */
.settings-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
  align-items: center;
}

/* full -> occupies both columns */
.settings-grid .full { grid-column: 1 / -1; }

/* compact buttons */
.btn-compact,
.main-btn.btn-compact,
.main-btn {
  padding: 8px 10px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 700;
  min-height: 38px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

/* res buttons group */
.res-buttons {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  align-items: center;
}
.res-btn {
  padding: 6px 8px;
  border-radius: 8px;
  min-width: 48px;
  font-weight: 800;
  font-size: 12px;
  cursor: pointer;
}
.res-btn.selected {
  outline: 2px solid #ffd54f;
  box-shadow: 0 4px 8px rgba(0,0,0,0.12);
}

/* sanjo image compact */
.sanjo-image { width: 100%; height: 100px; display:flex; align-items:center; justify-content:center; overflow:hidden; }
.sanjo-image img { max-height: 100%; width: auto; }

/* vel-pill & gallery-pill (shared appearance) */
.vel-pill,
.gallery-pill {
  display: flex;
  align-items: center;
  gap: 12px;
  background: linear-gradient(180deg,#f9fbfe,#f1f8ff);
  border-radius: 10px;
  padding: 6px 8px;
  box-shadow: 0 6px 18px rgba(16,40,64,0.03);
}

/* input range inside pills */
.vel-pill input[type='range'],
.gallery-pill input[type='range'] {
  width: calc(100% - 110px);
  height: 8px;
  border-radius: 8px;
  background: linear-gradient(90deg,#2fb6e6,#ff8d28);
  outline: none;
}

/* slider thumb */
.vel-pill input[type='range']::-webkit-slider-thumb,
.gallery-pill input[type='range']::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #fff;
  border: 3px solid #0b6f86;
  box-shadow: 0 4px 10px rgba(3,45,60,0.16);
  cursor: pointer;
}

/* vel-small compact */
.vel-small {
  width: 44px;
  height: 38px;
  border-radius: 8px;
  font-weight: 900;
  font-size: 16px;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* center label/value block */
.vel-center { width:110px; display:flex; flex-direction:column; gap:2px; align-items:center; justify-content:center; }
.vel-name { font-size:12px; color:#033; font-weight:700; text-align:center; }
.vel-value { font-size:13px; font-weight:900; color:#042; text-align:center; }
#gallery-value {font-size:13px; font-weight:900; color:#042; text-align:center;}

/* small responsive fallback */
@media (max-width: 560px) {
  .settings-grid { grid-template-columns: 1fr; }
  .vel-pill input[type='range'], .gallery-pill input[type='range'] { width: calc(100% - 90px); }
  .vel-center { width: 90px; }
}

/* accessibility focus */
.settings-panel button:focus { outline: 2px solid rgba(79,70,229,0.2); outline-offset: 2px; }

/* ensure compact panel doesn't overflow */
.settings-panel { padding: 10px; gap: 8px; box-sizing: border-box; overflow: visible; }


.settings-panel { height: 100%; display: block; box-sizing: border-box; }
.settings-grid  { height: 100%; box-sizing: border-box; }

.settings-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-template-rows: auto auto 1fr auto;
  gap: 10px;
  padding: 8px;            
  min-height: 0;       
}

.settings-grid .full { grid-column: 1 / -1; }

.sanjo-grow {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  padding: 6px 4px;
  min-height: 0;  /* avoid overflow with children flex */
}

.sanjo-image {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  box-sizing: border-box;
  background-color: transparent;
}

.sanjo-image img {
  display: block;
  height: 100%;
  max-width: 100%;
  width: auto;
  object-fit: contain;
  margin: 0 auto;
  border-radius: 8px; 
  transition: transform .12s ease, max-height .12s ease;
}

.footer-buttons {
  display: flex;
  gap: 8px;
  width: 100%;
  justify-content: space-between;
}
/* ===== Patterns: large square â€” two per row (replace previous patterns rules) ===== */

/* container occupies full panel content space so rows can grow */
.patterns-container {
  display: grid;
  grid-template-columns: repeat(2, 1fr); /* two per row */
  gap: 10px;            /* spacing between thumbnails */
  padding: 8px;         /* reduce padding to use space */
  box-sizing: border-box;
  overflow-y: auto;
  height: calc(100% - 8px); /* occupy most of available panel */
  align-content: start;
  grid-auto-rows: 1fr;  /* flexible rows that fill space */
}

/* each pattern is square and fills its cell */
.pattern {
  width: 100%;
  aspect-ratio: 1 / 1;   /* force square (modern browsers) */
  min-height: 150px;     /* ensure legible size on small screens */
  border-radius: 10px;
  border: 3px solid #ccc;
  background: #fff;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: transform .18s ease, box-shadow .18s ease, border-color .12s ease;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}

/* increase size on large screens */
@media (min-width: 900px) {
  .patterns-container { gap: 12px; padding: 10px; }
  .pattern { min-height: 220px; }
}

/* image fills and crops if needed */
.pattern-img,
.pattern {
  object-fit: cover;
  width: 100%;
  height: 100%;
  display: block;
}

/* hover/focus similar to old style: subtle lift */
.pattern:hover,
.pattern:focus {
  transform: translateY(-6px) scale(1.02);
  box-shadow: 0 10px 26px rgba(0,0,0,0.18);
  z-index: 2;
}

/* selected (yellow similar to your old) */
.pattern.selected,
.pattern.pattern-active {
  border-color: #FFD700;
  box-shadow: 0 10px 28px rgba(255,215,0,0.28);
  transform: translateY(-6px) scale(1.04);
}

/* if you need fallback compatibility (older browsers) */
@supports not (aspect-ratio: 1 / 1) {
  .pattern { height: 0; padding-top: 100%; position: relative; }
  .pattern-img { position: absolute; top:0; left:0; width:100%; height:100%; object-fit:cover; }
}

/* scrollbar: return to clean old style */
.patterns-container::-webkit-scrollbar,
.panel-content::-webkit-scrollbar { width: 8px; }
.patterns-container::-webkit-scrollbar-thumb,
.panel-content::-webkit-scrollbar-thumb {
  background: var(--panel-scroll);
  border-radius: 6px;
}
.patterns-container::-webkit-scrollbar-thumb:hover,
.panel-content::-webkit-scrollbar-thumb:hover { background: #a9aec0; }

/* Firefox */
.patterns-container, .panel-content { scrollbar-width: thin; scrollbar-color: var(--panel-scroll) transparent; }

/* mobile: 1 column and smaller min-height */
@media (max-width: 520px) {
  .patterns-container { grid-template-columns: 1fr; gap: 8px; padding: 6px; }
  .pattern { min-height: 120px; border-radius: 8px; }
}

/* Accessibility */
.pattern:focus { outline: 3px solid rgba(255,215,0,0.25); outline-offset: 2px; }

.pattern-active { border-color: #4f46e5 !important; box-shadow: 0 12px 30px rgba(79,70,229,0.12) !important; transform: translateY(-6px) scale(1.04) !important; }
.pattern-stop-indicator { outline: 3px dashed #ff5252 !important; }    



/* Ensure the block stays inside the cube area */
.cube-area { position: relative; }

/* Sequence display: absolute inside .cube-area, horizontally centered */
.sequence-display{
  position: absolute;
  left: 35%;
  transform: translateX(-50%);
  bottom: 95px;               /* distance above the button bar / bottom edge */
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px;
  border-radius: 10px;
  min-width: 220px;
  max-width: 86%;             /* never wider than the cube area */
  width: min(820px, 72%);
  box-sizing: border-box;
  background: rgba(10,12,14,0.65); /* semi-transparent so it doesn't cover too much */
  color: #e6eefc;
  border: 1px solid rgba(255,255,255,0.04);
  backdrop-filter: blur(4px);
  font-family: 'Poppins', sans-serif;
  font-size: 13px;
  z-index: 40;                /* above the canvas but below the right panel */
  pointer-events: none;       /* display-only â€” does not interact with clicks */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* label and text */
.sequence-display .seq-label { font-weight:700; margin-right:6px; opacity:0.9; }
.sequence-summary { display:inline-block; vertical-align:middle; max-width: calc(100% - 80px); overflow:hidden; text-overflow:ellipsis; }

/* mobile: stack and adjust size */
@media (max-width: 780px){
  .sequence-display{ left: 50%; bottom: 8px; width: calc(100% - 32px); transform: translateX(-50%); font-size:12px; }
  .sequence-summary{ max-width: calc(100% - 90px); white-space:nowrap; }
}

/* Light/dark compatibility */
body.light-mode .sequence-display{
  background: rgba(255,255,255,0.85);
  color:#0b1a24;
  border: 1px solid rgba(0,0,0,0.06);
}
